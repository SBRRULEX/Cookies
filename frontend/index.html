<!DOCTYPE html>
<html>
<head>
  <title>Facebook Bot</title>
  <style>
    body { font-family: Arial; background: #111; color: #eee; padding: 20px; }
    input, textarea, button {
      width: 100%; padding: 10px; margin: 10px 0; font-size: 16px; border-radius: 8px; border: none;
    }
    button { background: #2ecc71; color: white; cursor: pointer; }
    textarea { height: 150px; }
    .corner-link {
      position: fixed; top: 10px; right: 10px; background: #3498db; padding: 10px;
      color: #fff; border-radius: 8px; text-decoration: none;
    }
  </style>
</head>
<body>
  <a class="corner-link" href="/cookie-extractor" target="_blank">🍪 Get Cookie</a>
  <h2>📤 Send Facebook Messages</h2>
  <form id="sendForm">
    <input type="file" id="authFile" required>
    <input type="file" id="uidFile" required>
    <textarea id="messageFile" placeholder="Type messages..."></textarea>
    <input type="number" id="delay" placeholder="Delay in seconds" value="5">
    <button type="submit">🚀 Start</button>
  </form>
  <div id="log" style="white-space: pre-line; margin-top: 20px;"></div>
  <script>
    document.getElementById('sendForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const token = await readFile(document.getElementById('authFile').files[0]);
      const uid = await readFile(document.getElementById('uidFile').files[0]);
      const message = document.getElementById('messageFile').value;
      const delay = document.getElementById('delay').value;

      const res = await fetch('/send', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token, uid, message, delay })
      });

      const data = await res.json();
      document.getElementById('log').innerText = '✅ Sending Started...\nStop Code: ' + data.stopCode;
    });

    const readFile = (file) => new Promise((res, rej) => {
      const reader = new FileReader();
      reader.onload = () => res(reader.result);
      reader.onerror = () => rej(reader.error);
      reader.readAsText(file);
    });
  </script>
</body>
</html>
